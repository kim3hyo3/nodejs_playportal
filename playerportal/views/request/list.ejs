<!DOCTYPE html>
<html lang="en">
<head>
  <% include ../layout/head.ejs %>
  <link rel='stylesheet' href='/stylesheets/style.css'/>
</head>
<body>
  <% include ../layout/nav.ejs %>
  <div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <div class="col-md-2">
        <a href="#" class="list-group-item active">
          요청 목록
        </a>
        <li class="list-group-item">
          <a class="btn btn-primary btn-lg btn-block" href="https://www.docswave.com/v2/myurl/playauto" role="button">전자결재</a>
          <a class="btn btn-primary btn-lg btn-block" href="http://manual.playauto.co.kr/login.html" role="button">메뉴얼</a>
        </li>
      </div>
      <div class="col-md-10">
        <div class="list-group">
          <li class="list-group-item active"><h4>요청 목록</h4></li>
          <li class="list-group-item">
            <!--글쓰기-->
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapsewrite" aria-expanded="false" aria-controls="collapsewrite">
              글쓰기
            </button>
            <div class="collapse" id="collapsewrite">
              <div class="panel panel-default">
                <div class="panel-body">
                  <form action="/request/write" method="post" onsubmit="return onWriteSubmit()">
                    <table class="table col-md-12">
                      <tr>
                        <th class="col-md-1">종류</th>
                        <td class="col-md-1"><input type="text" name="type" id="type"/></td>
                        <th class="col-md-1">제목</th>
                        <td class="col-md-2"><input type="text" name="title" id="title"/></td>
                        <th class="col-md-1">내용</th>
                        <td class="col-md-6">
                          <textarea name="content" id="content"></textarea>
                        </td>
                      </tr>
                      <tr>
                        <td colspan="2">
                          <button type="submit">글쓰기</button>
                        </td>
                      </tr>
                      <!--<div class="dropdown">
                       <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                         Dropdown
                         <span class="caret"></span>
                       </button>
                       <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                         <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Action</a></li>
                         <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Another action</a></li>
                         <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Something else here</a></li>
                         <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Separated link</a></li>
                       </ul>
                      </div>-->
                    </table>
                  </form>
                </div>
              </div>
            </div>

            <!--글수정-->
            <%for(var i = 0; i < rows.length;i++){%>
            <div class="collapse" id="collapse<%=rows[i].id_request%>">
              <div class="panel panel-default">
                <div class="panel-body">
                  <!--<form action="/request/write" method="post" onsubmit="return onWriteSubmit()">-->
                  <form action="/request/edit" method="post">
                    <!--onsubmit="return onUpdateSubmit()">-->
                    <table class="table col-md-12">
                      <!--<input type="hidden" name="_method" value="PUT">-->
                      <tr>
                        <th class="col-md-1">글번호</th>
                        <th class="col-md-1">종류</th>
                        <th class="col-md-1">제목</th>
                        <th class="col-md-7">내용</th>
                        <th class="col-md-2">수정시간</th>
                      </tr>
                      <tr>
                        <th class="col-md-1">
                          <input class="form-control" type="text" name="id_request" value="<%=rows[i].id_request%>" readonly>
                        </th>
                        <td class="col-md-1">
                          <input class="form-control" type="text" name="type"/>
                        </td>
                        <td class="col-md-1">
                          <input class="form-control" type="text" name="title"/>
                        </td>
                        <td class="col-md-7">
                          <input class="form-control" name="content">
                        </td>
                        <th class="col-md-2">수정시간</th>
                      </tr>
                      <tr>
                        <td>
                          <button type="submit">글수정</button>
                        </td>
                      </tr>
                    </table>
                  </form>
                </div>
              </div>
            </div>
            <%}%>

            <div class="panel panel-default">
              <!-- Table -->
              <table class="table table-bordered table-hover">
                <tr class="active">
                  <th class="col-md-1">번호</th>
                  <th class="col-md-1">종류</th>
                  <th class="col-md-6">제목</th>
                  <th class="col-md-1">작성자</th>
                  <th class="col-md-2">등록일</th>
                  <th class="col-md-1">조회수</th>
                </tr>
                <%for(var i = 0; i < rows.length;i++){%>
                <tr>
                  <td class="col-md-1">&nbsp;<span class="badge"><%=rows[i].id_request%></span>&nbsp;
                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse<%=rows[i].id_request%>" aria-expanded="false" aria-controls="collapse<%=rows[i].id_request%>">
                      글수정
                    </button>
                  </td>
                  <td class="col-md-1"><%=rows[i].type%></td>
                  <td class="col-md-6" data-toggle="collapse" href="#collapse<%=rows[i].id_request%>" aria-expanded="true" aria-controls="collapse<%=rows[i].id_request%>">
                    <div>
                      <%=rows[i].title%>
                    </div>
                    <div class="collapse in" id="collapse<%=rows[i].id_request%>">
                      <div>
                        <%=rows[i].content%>
                      </div>
                    </div>
                  </td>
                  <td class="col-md-1"><%=rows[i].m_cd%></td>
                  <td class="col-md-2"><%=rows[i].regdate%></td>
                  <td class="col-md-1"><%=rows[i].hit%></td>
                </tr>
                <%}%>
              </table>
            </div>

            <nav>
              <ul class="pagination">
                <li>
                  <a href="#" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                  </a>
                </li>
                <li><a href="#">1</a></li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li><a href="#">4</a></li>
                <li><a href="#">5</a></li>
                <li>
                  <a href="#" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                  </a>
                </li>
              </ul>
            </nav>
          </li>

          <script>
            function onWriteSubmit()
            {
              if ( $("#title").val().trim() == "" )
              {
                var message = "제목을 입력해 주세요";
                $("#title").val("");
                $("#title").focus();
                alert(message);
                return false;
              }

              if ( $("#content").val().trim() == "" )
              {
                var message = "본문 내용을 입력해 주세요";
                $("#content").val("");
                $("#content").focus();
                alert(message);
                return false;
              }
            }
            /*$('#requestUpdate').click(function () {
              function onUpdateSubmit() {
                $.ajax({
                  url: '/request/update',
                  type: 'post',
                  dataType: 'json',
                  data: {
                    id_request: $('#id_request').val(),
                    type: $('#type').val(),
                    title: $('#title').val(),
                    content: $('#content').val()
                  },
                  success: function (data) {
                    console.log(data);
                    $('#output').val(data);
                  },
                  error: function (err) {
                    console.log(err.toString());
                  }
                });
              }
            }*/
          </script>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>
