<!DOCTYPE html>
<html lang="en">
<head>
<% include ../layout/head.ejs %>
<link rel='stylesheet' href='/stylesheets/style.css'/>
</head>
<body>
<% include ../layout/nav.ejs %>
<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <div class="col-md-2">
        <a href="#" class="list-group-item active">
          요청 목록
        </a>
        <li class="list-group-item">
          <a class="btn btn-primary btn-lg btn-block" href="https://www.docswave.com/v2/myurl/playauto" role="button">전자결재</a>
          <a class="btn btn-primary btn-lg btn-block" href="http://manual.playauto.co.kr/login.html" role="button">메뉴얼</a>
        </li>
      </div>
      <div class="col-md-10">
        <div class="list-group">
          <li class="list-group-item active"><h4>요청 목록</h4></li>
          <li class="list-group-item">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
              글쓰기
            </button>
            <div class="collapse" id="collapseExample">
              <div class="panel panel-default">
                <div class="panel-body">
                  <form action="/request/write" method="post" onsubmit="return onWriteSubmit()">
                    <table class="table">
                      <tr>
                        <th>종류</th>
                      </tr>
                      <tr>
                        <td><input type="dropdown" name="type" id="type"/></td>
                      </tr>
                      <tr>
                        <th>제목</th>
                        <th>내용</th>
                      </tr>
                      <tr>
                        <td><input type="text" name="title" id="title"/></td>
                        <td><textarea name="content" id="content"></textarea></td>
                        <td colspan="2">
                          <button type="submit">글쓰기</button>
                        </td>
                      </tr>
                      </tbody>
                    </table>
                  </form>
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <!-- Table -->
              <table class="table table-bordered table-hover">
                <tr class="active">
                  <th class="col-md-1">번호</th>
                  <th class="col-md-7">요청제목</th>
                  <th class="col-md-1">작성자</th>
                  <th class="col-md-2">요청시간</th>
                  <th class="col-md-1">조회수</th>
                </tr>
                <%for(var i = 0; i < rows.length;i++){%>
                <tr>
                  <td class="col-md-1"><%=rows[i].id_request%></td>
                  <td class="col-md-7" data-toggle="collapse" href="#collapse<%=rows[i].id_request%>" aria-expanded="true" aria-controls="collapse<%=rows[i].id_request%>">
                    <div>
                      <%=rows[i].title%>
                    </div>
                    <div class="collapse in" id="collapse<%=rows[i].id_request%>">
                      <div>
                        <%=rows[i].content%>
                      </div>
                    </div>
                  </td>
                  <td class="col-md-1"><%=rows[i].m_cd%></td>
                  <td class="col-md-2"><%=rows[i].modidate%></td>
                  <td class="col-md-1"><%=rows[i].hit%></td>
                </tr>
                <%}%>
              </table>
            </div>

            <nav>
              <ul class="pagination">
                <li>
                  <a href="#" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                  </a>
                </li>
                <li><a href="#">1</a></li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li><a href="#">4</a></li>
                <li><a href="#">5</a></li>
                <li>
                  <a href="#" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                  </a>
                </li>
              </ul>
            </nav>
          </li>

          <script>
            function onWriteSubmit()
            {
              if ( $("#title").val().trim() == "" )
              {
                var message = "제목을 입력해 주세요";
                $("#title").val("");
                $("#title").focus();
                alert(message);
                return false;
              }

              if ( $("#content").val().trim() == "" )
              {
                var message = "본문 내용을 입력해 주세요";
                $("#content").val("");
                $("#content").focus();
                alert(message);
                return false;
              }
            }

            $('#requestGet').click(function () {
              $.ajax({
                url: '/products',
                type: 'post',
                dataType: 'json',
                data: {
                  name: $('#name').val(),
                  price: $('#price').val()
                },
                success: function (data) {
                  $('#output').val(data);
                },
                error : function (err) {
                  console.log(err.toString());
                }
              });
            });
          </script>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>
